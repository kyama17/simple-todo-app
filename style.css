:root {
    --body-bg-gradient-start: #667eea;
    --body-bg-gradient-end: #764ba2;
    --container-bg: white;
    --container-shadow: rgba(0, 0, 0, 0.2);
    --header-bg-gradient-start: #667eea;
    --header-bg-gradient-end: #764ba2;
    --header-text-color: white;
    --input-border-color: #e0e0e0;
    --input-focus-border-color: #667eea;
    --input-bg-color: white; /* Added for inputs */
    --input-text-color: #333; /* Added for inputs */
    --button-primary-bg: #667eea;
    --button-primary-hover-bg: #5a6fd8;
    --button-primary-text: white;
    --filter-btn-border-color: #e0e0e0;
    --filter-btn-bg: white;
    --filter-btn-text: #333; /* Added for filter button text */
    --filter-btn-active-bg: #667eea;
    --filter-btn-active-text: white;
    --filter-btn-active-border: #667eea;
    --stats-text-color: #666;
    --todo-item-border-bottom: #f0f0f0;
    --todo-item-hover-bg: #f8f9fa;
    --todo-item-completed-opacity: 0.6;
    --todo-item-completed-text-color: #999;
    --todo-text-color: #333; /* General text within todo item */
    --todo-date-text-color: #999;
    --delete-btn-bg: #ff6b6b;
    --delete-btn-hover-bg: #ff5252;
    --delete-btn-text: white;
    --action-btn-bg: #4CAF50; /* Edit/Save */
    --action-btn-hover-bg: #45a049;
    --action-btn-text: white;
    --move-btn-bg: #007bff;
    --move-btn-hover-bg: #0056b3;
    --move-btn-text: white;
    --disabled-btn-bg: #ccc;
    --disabled-btn-text: #888; /* Added for disabled button text */
    --disabled-btn-opacity: 0.6;
    --priority-high-border: #ff6b6b;
    --priority-medium-border: #ffc107;
    --priority-low-border: #4CAF50;
    --priority-selector-bg: #f8f9fa;
    --priority-selector-border: #ddd;
    --priority-selector-text: #333; /* Added for selector text */
    --task-due-date-text: #777;
    --overdue-text-color: red;
    --due-soon-text-color: orange;
    --actions-border-top: #f0f0f0;
    --clear-btn-bg: #ff6b6b;
    --clear-btn-hover-bg: #ff5252;
    --clear-btn-text: white;
    --scrollbar-track-bg: #f1f1f1;
    --scrollbar-thumb-bg: #c1c1c1;
    --scrollbar-thumb-hover-bg: #a8a8a8;
    --theme-toggle-btn-bg: #fff;
    --theme-toggle-btn-text: #333;
    --theme-toggle-btn-hover-bg: #eee;
}

body.dark-theme {
    --body-bg-gradient-start: #2c3e50;
    --body-bg-gradient-end: #465a70;
    --container-bg: #34495e;
    --container-shadow: rgba(0, 0, 0, 0.4);
    --header-bg-gradient-start: #2c3e50;
    --header-bg-gradient-end: #465a70;
    --header-text-color: #ecf0f1;
    --input-border-color: #566573;
    --input-focus-border-color: #3498db;
    --input-bg-color: #2c3e50;
    --input-text-color: #ecf0f1;
    --button-primary-bg: #3498db;
    --button-primary-hover-bg: #2980b9;
    --button-primary-text: #ecf0f1;
    --filter-btn-border-color: #566573;
    --filter-btn-bg: #3e5770;
    --filter-btn-text: #ecf0f1;
    --filter-btn-active-bg: #3498db;
    --filter-btn-active-text: #ecf0f1;
    --filter-btn-active-border: #3498db;
    --stats-text-color: #bdc3c7;
    --todo-item-border-bottom: #4a637a;
    --todo-item-hover-bg: #3e5770;
    --todo-item-completed-opacity: 0.5;
    --todo-item-completed-text-color: #95a5a6;
    --todo-text-color: #ecf0f1;
    --todo-date-text-color: #95a5a6;
    --delete-btn-bg: #e74c3c;
    --delete-btn-hover-bg: #c0392b;
    --delete-btn-text: #ecf0f1;
    --action-btn-bg: #2ecc71;
    --action-btn-hover-bg: #27ae60;
    --action-btn-text: #ecf0f1;
    --move-btn-bg: #5dade2;
    --move-btn-hover-bg: #4b8fba;
    --move-btn-text: #ecf0f1;
    --disabled-btn-bg: #566573;
    --disabled-btn-text: #95a5a6;
    --disabled-btn-opacity: 0.5;
    --priority-high-border: #e74c3c;
    --priority-medium-border: #f39c12;
    --priority-low-border: #2ecc71;
    --priority-selector-bg: #2c3e50;
    --priority-selector-border: #566573;
    --priority-selector-text: #ecf0f1;
    --task-due-date-text: #bdc3c7;
    --overdue-text-color: #e74c3c;
    --due-soon-text-color: #f39c12;
    --actions-border-top: #4a637a;
    --clear-btn-bg: #e74c3c;
    --clear-btn-hover-bg: #c0392b;
    --clear-btn-text: #ecf0f1;
    --scrollbar-track-bg: #2c3e50;
    --scrollbar-thumb-bg: #566573;
    --scrollbar-thumb-hover-bg: #6b7f93;
    --theme-toggle-btn-bg: #4a637a;
    --theme-toggle-btn-text: #ecf0f1;
    --theme-toggle-btn-hover-bg: #56708a;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, var(--body-bg-gradient-start) 0%, var(--body-bg-gradient-end) 100%);
    color: var(--text-color); /* General text color for body */
    min-height: 100vh;
    padding: 20px;
    transition: background 0.3s, color 0.3s;
}

.container {
    max-width: 600px;
    margin: 0 auto;
    background: var(--container-bg);
    border-radius: 15px;
    box-shadow: 0 10px 30px var(--container-shadow);
    overflow: hidden;
    transition: background 0.3s;
}

header {
    background: linear-gradient(135deg, var(--header-bg-gradient-start) 0%, var(--header-bg-gradient-end) 100%);
    color: var(--header-text-color);
    padding: 20px 30px; /* Adjusted padding */
    text-align: center;
    display: flex; /* For aligning title and button */
    justify-content: space-between; /* Space between title and button */
    align-items: center; /* Vertically align items */
    transition: background 0.3s, color 0.3s;
}

header h1 {
    font-size: 2.2em; /* Slightly reduced for space */
    font-weight: 300;
    margin: 0; /* Remove default margin */
}

#themeToggleBtn {
    background: var(--theme-toggle-btn-bg);
    color: var(--theme-toggle-btn-text);
    border: none;
    border-radius: 50%; /* Circular button */
    padding: 10px;
    font-size: 1.2em; /* Adjust icon size */
    cursor: pointer;
    transition: background 0.3s, color 0.3s;
    width: 40px; /* Fixed width */
    height: 40px; /* Fixed height */
    display: flex;
    justify-content: center;
    align-items: center;
}

#themeToggleBtn:hover {
    background: var(--theme-toggle-btn-hover-bg);
}


.todo-input {
    padding: 30px;
    display: flex;
    gap: 15px;
    background-color: var(--container-bg); /* Ensure this part also uses var */
}

#todoInput, #dueDateInput, .edit-input, .edit-due-date-input {
    flex: 1;
    padding: 15px;
    border: 2px solid var(--input-border-color);
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    border-radius: 8px;
    font-size: 16px;
    outline: none;
    transition: border-color 0.3s, background-color 0.3s, color 0.3s;
}
#todoInput:focus, #dueDateInput:focus, .edit-input:focus, .edit-due-date-input:focus {
    border-color: var(--input-focus-border-color);
}

#dueDateInput {
    width: auto; /* Adjust width as needed */
}

#addBtn {
    padding: 15px 25px;
    background: var(--button-primary-bg);
    color: var(--button-primary-text);
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
}

#addBtn:hover {
    background: var(--button-primary-hover-bg);
}

.filter-buttons {
    padding: 0 30px;
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    background-color: var(--container-bg); /* Ensure this part also uses var */
}

.filter-btn {
    padding: 10px 20px;
    border: 2px solid var(--filter-btn-border-color);
    background: var(--filter-btn-bg);
    color: var(--filter-btn-text);
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 14px;
}

.filter-btn.active,
.filter-btn:hover {
    background: var(--filter-btn-active-bg);
    color: var(--filter-btn-active-text);
    border-color: var(--filter-btn-active-border);
}

#searchInput {
    padding: 10px 15px;
    border: 2px solid var(--input-border-color);
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    border-radius: 20px; /* Match filter buttons */
    font-size: 14px;
    outline: none;
    transition: border-color 0.3s, background-color 0.3s, color 0.3s;
    margin-left: auto; /* Pushes search to the right */
    flex-grow: 0.5; /* Allow it to take some space */
}

#searchInput:focus {
    border-color: var(--input-focus-border-color);
}


.todo-stats {
    padding: 0 30px 20px;
    color: var(--stats-text-color);
    font-size: 14px;
    text-align: center;
    background-color: var(--container-bg); /* Ensure this part also uses var */
}

.todo-list {
    list-style: none;
    max-height: 400px;
    overflow-y: auto;
    background-color: var(--container-bg); /* Ensure this part also uses var */
}

.todo-item {
    display: flex;
    align-items: center;
    padding: 20px 30px;
    border-bottom: 1px solid var(--todo-item-border-bottom);
    transition: background 0.3s;
    background-color: var(--container-bg); /* Each item's default bg */
    color: var(--todo-text-color); /* General text color for item content */
}

.todo-item:hover {
    background: var(--todo-item-hover-bg);
}

.todo-item.completed {
    opacity: var(--todo-item-completed-opacity);
}

.todo-item.completed .todo-text {
    text-decoration: line-through;
    color: var(--todo-item-completed-text-color);
}

.todo-checkbox {
    width: 20px;
    height: 20px;
    margin-right: 15px;
    cursor: pointer;
    /* Consider styling checkbox appearance if default is not good for dark theme */
}

.todo-text {
    flex: 1;
    font-size: 16px;
    word-break: break-word;
    color: var(--todo-text-color); /* Explicitly set */
}

.todo-date {
    font-size: 12px;
    color: var(--todo-date-text-color);
    margin-right: 15px;
}

.delete-btn {
    background: var(--delete-btn-bg);
    color: var(--delete-btn-text);
    /* other properties remain same */
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 12px;
    transition: background 0.3s;
}

.delete-btn:hover {
    background: var(--delete-btn-hover-bg);
}

.todo-actions {
    display: flex;
    align-items: center;
    margin-left: auto; /* Pushes action buttons to the right */
}

.edit-btn, .save-btn, .move-up-btn, .move-down-btn {
    /* Base styles are color, border, radius, padding, cursor, font-size, transition, margin-left */
    color: var(--action-btn-text); /* Default for edit/save, overridden for move */
    border: none;
    border-radius: 5px;
    padding: 6px 10px; 
    cursor: pointer;
    font-size: 12px;
    transition: background 0.3s;
    margin-left: 5px; 
}
.edit-btn, .save-btn {
    background: var(--action-btn-bg);
}
.edit-btn:hover, .save-btn:hover {
    background: var(--action-btn-hover-bg);
}

.move-up-btn, .move-down-btn {
    background: var(--move-btn-bg);
    color: var(--move-btn-text); /* Specific for move buttons if different */
    padding: 4px 8px; 
}

.move-up-btn:hover, .move-down-btn:hover {
    background: var(--move-btn-hover-bg);
}

.move-up-btn:disabled, .move-down-btn:disabled,
.delete-btn:disabled, .edit-btn:disabled, .save-btn:disabled, #addBtn:disabled, .clear-btn:disabled {
    background: var(--disabled-btn-bg);
    color: var(--disabled-btn-text); /* Added for disabled text */
    cursor: not-allowed;
    opacity: var(--disabled-btn-opacity);
}


.edit-input { /* Already covered by the combined rule above */
    /* flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 15px; margin-right: 10px; */
}

.edit-input-container {
    display: flex;
    flex-direction: column; 
    flex: 1;
    gap: 5px; 
    margin-right: 10px;
}

.edit-due-date-input { /* Already covered by the combined rule above */
    /* padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; */
}


/* Priority Styles */
.todo-item.priority-high {
    border-left: 5px solid var(--priority-high-border);
}
.todo-item.priority-medium {
    border-left: 5px solid var(--priority-medium-border);
}
.todo-item.priority-low {
    border-left: 5px solid var(--priority-low-border);
}

.priority-selector {
    margin-left: 10px; 
    margin-right: 10px; 
    padding: 4px 8px;
    border-radius: 4px;
    border: 1px solid var(--priority-selector-border);
    font-size: 12px;
    background-color: var(--priority-selector-bg);
    color: var(--priority-selector-text); /* Added */
    height: fit-content; 
    align-self: center; 
    transition: background-color 0.3s, color 0.3s, border-color 0.3s;
}

.task-due-date {
    font-size: 12px;
    color: var(--task-due-date-text);
    margin-left: 10px;
    margin-right: 10px;
    align-self: center;
}

/* Visual Reminders for Due Dates */
.todo-item.overdue:not(.completed) .todo-text,
.todo-item.overdue:not(.completed) .task-due-date {
    color: var(--overdue-text-color);
    font-weight: bold;
}

.todo-item.due-soon:not(.completed) .todo-text,
.todo-item.due-soon:not(.completed) .task-due-date {
    color: var(--due-soon-text-color);
}


.actions {
    padding: 20px 30px;
    text-align: center;
    border-top: 1px solid var(--actions-border-top);
    background-color: var(--container-bg); /* Ensure this part also uses var */
    transition: background-color 0.3s, border-top-color 0.3s;
}

.clear-btn {
    background: var(--clear-btn-bg);
    color: var(--clear-btn-text);
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
}

.clear-btn:hover {
    background: var(--clear-btn-hover-bg);
}

.clear-btn:disabled { /* Already covered by combined rule */
    /* background: var(--disabled-btn-bg); */
    /* cursor: not-allowed; */
}

.hidden {
    display: none !important;
}

/* レスポンシブデザイン */
@media (max-width: 768px) {
    .container {
        margin: 10px;
        border-radius: 10px;
    }
    
    header {
        padding: 15px 20px; /* Adjust header padding */
    }
    header h1 {
        font-size: 1.8em; /* Adjust title size */
    }
    #themeToggleBtn {
        padding: 8px;
        font-size: 1em;
        width: 35px;
        height: 35px;
    }
    
    .todo-input {
        padding: 20px;
        flex-direction: column;
    }
    
    .filter-buttons {
        padding: 0 20px;
        flex-wrap: wrap;
    }
    
    .todo-item {
        padding: 15px 20px;
        flex-wrap: wrap; /* Allow items to wrap on small screens */
    }
    .todo-actions {
        margin-left: 0; /* Reset margin for wrapped layout */
        width: 100%; /* Take full width */
        margin-top: 10px; /* Add space when wrapped */
        justify-content: flex-end; /* Align buttons to the right */
    }
    
    .todo-text {
        font-size: 14px;
    }
}

/* スクロールバーのスタイリング */
.todo-list::-webkit-scrollbar {
    width: 8px;
}

.todo-list::-webkit-scrollbar-track {
    background: var(--scrollbar-track-bg);
}

.todo-list::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb-bg);
    border-radius: 4px;
}

.todo-list::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover-bg);
}